window.Tilda=window.Tilda||{},function(e){Tilda.sendEcommerceEvent=function(t,i){if(void 0===i||0==i.length)return!1;if(void 0===t||"add"!=t&&"remove"!=t&&"purchase"!=t&&"detail"!=t)return!1;for(var r,a,d,c="",o=0,n=[],m="",l="",s="",p=0;p<i.length;p++){""<c&&(c+=", "),c+=(d=i[p]).name,o+=d.price,a="",void 0!==d.options&&0<d.options.length&&e.each(d.options,(function(e,t){a+=t.option+": "+t.variant+"; "}));var u={name:d.name,price:d.price,variant:a,quantity:1};d.id&&0<d.id&&(id=d.id,u.id=d.id),d.uid&&0<d.uid&&(l=d.uid,u.uid=d.uid),d.recid&&0<d.recid&&(m=d.recid,u.recid=d.recid),d.lid&&0<d.lid&&(s=d.lid,u.lid=d.lid),d.sku&&0<d.sku&&(u.sku=d.sku),n[n.length]=u}"add"!=t&&"remove"!=t||(r="/tilda/cart/"+t+"/",0<m&&(r+=""+m),0<l?r+="-u"+l:0<s&&(r+="-"+s)),"detail"==t&&(r="/tilda/product/detail/",0<l?r+=l+"/":(0<m&&(r+="r"+m),0<s&&(r+="-l"+s))),"purchase"==t&&(r="/tilda/rec"+m+"/payment/"),(u={ecommerce:{}}).ecommerce[t]={products:n},Tilda.sendEventToStatistics(r,c,u,o)},Tilda.sendEventToStatistics=function(t,i,r,a){var d,c="/"==t.substring(0,1),o=[],n=0,m=!(!(m=e("#allrecords").data("fb-event"))||"nosend"!=m),l=!(!(l=e("#allrecords").data("vk-event"))||"nosend"!=l),s=e("#allrecords").data("tilda-currency")||e(".t706").data("project-currency-code")||"RUB";if(r=r||window.location.href,0<(a=a?parseFloat(a):0))if(window.dataLayer||(window.dataLayer=[]),-1!=t.indexOf("/tilda/")&&-1!=t.indexOf("/payment/")&&window.tildaForm&&""<window.tildaForm.orderIdForStat)r={ecommerce:{purchase:{actionField:{id:window.tildaForm.orderIdForStat,revenue:window.tildaForm.amountForStat},products:window.tildaForm.arProductsForStat}}},window.tildaForm.tildapayment&&window.tildaForm.tildapayment.promocode&&(r.ecommerce.purchase.actionField.coupon=window.tildaForm.tildapayment.promocode),r.event="purchase";else if(r&&r.ecommerce&&(r.ecommerce.add&&r.ecommerce.add.products?o=r.ecommerce.add.products:r.ecommerce.remove&&r.ecommerce.remove.products?o=r.ecommerce.remove.products:r.ecommerce.detail&&r.ecommerce.detail.products&&(o=r.ecommerce.detail.products),o&&0<o.length)){for(n=0;n<o.length;n++)o[n].id||(o[n].sku?o[n].id=o[n].sku:o[n].uid?o[n].id=o[n].uid:o[n].recid&&o[n].lid&&(o[n].id=o[n].recid+"_"+o[n].lid));r.ecommerce.add&&r.ecommerce.add.products?(r.ecommerce.add.products=o,r.event="addToCart"):r.ecommerce.remove&&r.ecommerce.remove.products?(r.ecommerce.remove.products=o,r.event="removeFromCart"):r.ecommerce.detail&&r.ecommerce.detail.products?(r.ecommerce.detail.products=o,r.event="viewProduct"):(c?(r.event="pageView",r.eventAction=t):r.event=t,r.title=i,r.value=a)}null!=window.dataLayer&&(c?0<a?r&&r.ecommerce?window.dataLayer.push(r):window.dataLayer.push({event:"pageView",eventAction:t,title:i,value:a,product:r}):window.dataLayer.push({event:"pageView",eventAction:t,title:i,referer:r}):r&&r.ecommerce?window.dataLayer.push(r):window.dataLayer.push({event:t,eventAction:i,value:a,referer:r}));try{window.gtagTrackerID&&"gtag"==window.mainTracker&&(c?r&&r.event?"purchase"==r.event?gtag("event","purchase",{transaction_id:r.ecommerce.purchase.actionField.id,value:parseFloat(a).toFixed(2),currency:s,items:r.ecommerce.purchase.products}):"addToCart"==r.event&&r.ecommerce.add?gtag("event","add_to_cart",{items:r.ecommerce.add.products}):"removeFromCart"==r.event&&r.ecommerce.remove?gtag("event","remove_from_cart",{items:r.ecommerce.remove.products}):"viewProduct"==r.event&&r.ecommerce.detail&&gtag("event","view_item",{items:r.ecommerce.detail.products}):gtag("config",window.gtagTrackerID,{page_title:i,page_path:t}):gtag("event",t,{event_category:"tilda",event_label:i,value:a}))}catch(t){}if(window.ga&&"tilda"!=window.mainTracker&&"gtag"!=window.mainTracker)if(c)if(r&&r.event){try{if(window.Tilda.isLoadGAEcommerce||(window.Tilda.isLoadGAEcommerce=!0,ga("require","ec")),ga("set","currencyCode",s),"purchase"==r.event){var p=r.ecommerce.purchase.products.length;for(g=0;g<p;g++)h=r.ecommerce.purchase.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","purchase",{id:r.ecommerce.purchase.actionField.id,revenue:parseFloat(a).toFixed(2)})}else if("addToCart"==r.event&&r.ecommerce.add){for(p=r.ecommerce.add.products.length,g=0;g<p;g++)h=r.ecommerce.add.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","add")}else if("removeFromCart"==r.event&&r.ecommerce.remove){for(p=r.ecommerce.remove.products.length,g=0;g<p;g++)h=r.ecommerce.remove.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","remove")}else if("viewProduct"==r.event&&r.ecommerce.detail){for(p=r.ecommerce.detail.products.length,g=0;g<p;g++)h=r.ecommerce.detail.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","detail")}}catch(t){}ga("send",{hitType:"pageview",page:t,title:i,params:r})}else ga("send",{hitType:"pageview",page:t,title:i});else ga("send",{hitType:"event",eventCategory:"tilda",eventAction:t,eventLabel:i,eventValue:a});if(window.mainMetrikaId&&0<window.mainMetrikaId&&"function"==typeof ym&&(c?(d={title:i},0<a&&(d.params={order_price:a},s&&(d.params.currency=s)),ym(window.mainMetrikaId,"hit",t,d)):0<a?(d={order_price:a},s&&(d.currency=s),ym(window.mainMetrikaId,"reachGoal",t,d)):ym(window.mainMetrikaId,"reachGoal",t)),""<window.mainMetrika&&window[window.mainMetrika]&&(c?0<a?window[window.mainMetrika].hit(t,{title:i,order_price:a,params:r}):window[window.mainMetrika].hit(t,{title:i}):0<a?window[window.mainMetrika].reachGoal(t,{title:i,params:r,order_price:a}):window[window.mainMetrika].reachGoal(t,{title:i,referer:r})),null!=window.fbq&&0==m)try{if(c)if(-1==t.indexOf("tilda/")||-1==t.indexOf("/payment/")&&-1==t.indexOf("/submitted/"))if(r&&r.event&&0<a)if("addToCart"==r.event&&r.ecommerce.add){p=r.ecommerce.add.products.length;var u=[];for(g=0;g<p;g++)h=r.ecommerce.add.products[g],u.push(h.id||h.uid||h.name);window.fbq("track","AddToCart",{content_ids:u,content_type:"product",value:a,currency:s})}else if("viewProduct"==r.event&&r.ecommerce.detail){for(p=r.ecommerce.detail.products.length,u=[],g=0;g<p;g++)h=r.ecommerce.detail.products[g],u.push(h.id||h.uid||h.name);window.fbq("track","ViewContent",{content_ids:u,content_type:"product",value:a,currency:s})}else t.indexOf("tilda/popup"),window.fbq("track","ViewContent",{content_name:i,content_category:t});else t.indexOf("tilda/popup"),window.fbq("track","ViewContent",{content_name:i,content_category:t});else 0<a&&s?window.fbq("track","InitiateCheckout",{content_name:i,content_category:t,value:a,currency:s}):window.fbq("track","Lead",{content_name:i,content_category:t});else window.fbq("track",t,{content_name:i,value:a})}catch(t){}if(void 0!==window.VK&&void 0!==window.VK.Retargeting&&0==l)try{if(c){var w=e("#allrecords").data("vk-price-list-id")?parseInt(e("#allrecords").data("vk-price-list-id")):0,v="",f=!1;if(r&&r.event)if(f={products:[],currency_code:"",total_price:0},"purchase"==r.event&&r.ecommerce.purchase)if(0<a&&0<w){for(f.currency_code=s,p=r.ecommerce.purchase.products.length,u=[],g=0;g<p;g++)h=r.ecommerce.purchase.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price||0}),f.total_price=a;v="init_checkout"}else v="t-purchase";else if("addToCart"==r.event&&r.ecommerce.add)if(0<a&&0<w){for(f.currency_code=s,p=r.ecommerce.add.products.length,u=[],g=0;g<p;g++)h=r.ecommerce.add.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price||0}),f.total_price=a;v="add_to_cart"}else v="t-add-to-cart",r.ecommerce.add[0]&&r.ecommerce.add[0].uid&&(v+="-"+r.ecommerce.add[0].uid);else if("viewProduct"==r.event&&r.ecommerce.detail)if(0<a&&0<w){for(f.currency_code=s,p=r.ecommerce.detail.products.length,u=[],g=0;g<p;g++)h=r.ecommerce.detail.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price||0}),f.total_price=a;v="view_product"}else v="t-view-product",r.ecommerce.detail[0]&&r.ecommerce.detail[0].uid&&(v+="-"+r.ecommerce.detail[0].uid);else if("removeFromCart"==r.event&&r.ecommerce.remmove)if(0<a&&0<w){f.currency_code=s;var h,g;p=r.ecommerce.remove.products.length,u=[];for(g=0;g<p;g++)h=r.ecommerce.remove.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price||0}),f.total_price=a;v="remove_from_cart"}else v="t-remove-product",r.ecommerce.remove[0]&&r.ecommerce.remove[0].uid&&(v+="-"+r.ecommerce.remove[0].uid);else v=r.event;else v=-1!=t.indexOf("tilda/")&&-1!=t.indexOf("/payment/")?"t-purchase-"+t.replace("/tilda/","").replace("tilda/","").replace("/payment/",""):-1!=t.indexOf("tilda/")&&-1!=t.indexOf("/submitted/")?"t-lead-"+t.replace("/tilda/","").replace("tilda/","").replace("/submitted/",""):-1!=t.indexOf("tilda/popup")||-1!=t.indexOf("tilda/click")?"t-"+t.replace("/tilda/","").replace("/","-"):"t-"+t.replace("/","-");0<w&&f&&f.currency_code?(VK.Retargeting.Event("purchase"),VK.Retargeting.ProductEvent(w,v,f)):(VK.Retargeting.Event(v),"t-purchase"==v.substring(0,10)?VK.Goal("purchase"):"t-lead"==v.substring(0,6)&&VK.Goal("lead"))}else VK.Retargeting.Event(t)}catch(t){}"0"<window.mainMailruId&&(l=window._tmr||(window._tmr=[]),c?0<a?l.push({id:""+window.mainMailruId,type:"pageView",url:t,value:a,start:(new Date).getTime()}):l.push({id:""+window.mainMailruId,type:"pageView",url:t,start:(new Date).getTime()}):0<a?l.push({id:""+window.mainMailruId,type:"reachGoal",goal:t,value:a}):l.push({id:""+window.mainMailruId,type:"reachGoal",goal:t})),"function"==typeof window.tildastat&&(c?(0<t.indexOf("payment")&&-1<t.indexOf("tilda/form")&&(t=t.replace("tilda/form","tilda/rec")),window.tildastat("pageview",{page:t})):window.tildastat("pageview",{page:"/tilda/event/"+t}))},Tilda.saveUTM=function(){try{var e=window.location.href,t="",i="";if(-1!==e.toLowerCase().indexOf("utm_")&&"string"==typeof(t=(t=(e=e.toLowerCase()).split("?"))[1])){var r,a=t.split("&");for(r in a)"utm_"==a[r].split("=")[0].substring(0,4)&&(i=i+a[r]+"|||");0<i.length&&((t=new Date).setDate(t.getDate()+30),document.cookie="TILDAUTM="+encodeURIComponent(i)+"; path=/; expires="+t.toUTCString())}}catch(e){}},e(document).ready((function(){var t;8!=(t=-1!=(t=navigator.userAgent.toLowerCase()).indexOf("msie")&&parseInt(t.split("msie")[1]))&&9!=t||e(".t-btn").each((function(){var t=e(this).attr("href");0<e(this).find("table").length&&""<t&&-1==t.indexOf("#popup:")&&-1==t.indexOf("#price:")&&e(this).click((function(t){t.preventDefault(),t=e(this).attr("href"),window.location.href=t}))}));try{1==e("#allrecords").length&&"no"==e("#allrecords").data("tilda-cookie")||Tilda.saveUTM()}catch(t){}e(".r").off("click","a.js-click-stat, .js-click-zero-stat"),e(".r").on("click","a.js-click-stat, .js-click-zero-stat",(function(t){var i=e(this).data("tilda-event-name"),r=e(this).text(),a=e(this).attr("href")||"",d=e(this).attr("target");i=i||"/tilda/click/".$(this).closest(".r").attr("id")+"/?url="+a;if(Tilda.sendEventToStatistics(i,r),"http"==a.substring(0,4))return window.setTimeout((function(){var t,i,r="",c="";if("_blank"==d){if(-1!=a.indexOf("?")&&(a=(r=a.split("?"))[0],-1!=(r=r[1]).indexOf("#")&&(r=r.split("#"),a=a+"#"+r[1],r=r[0]),r=r.split("&")),0==e("#tildaredirectform").length?e("body").append('<form id="tildaredirectform" target="_blank" method="GET" action="'+a+'" style="display:none;"></form>'):e("#tildaredirectform").attr("method","GET").attr("action",a),c="",0<r.length)for(t in r)(i=r[t].split("="))&&0<i.length&&(c+='<input type="hidden" name="'+i[0]+'" value="'+(i[1]||"")+'">');e("#tildaredirectform").html(c),e("#tildaredirectform").submit()}else window.location.href=a}),300),t.preventDefault(),!1})),e("input.js-amount").each((function(){var t=(t=e(this).val()).replace(/,/g,".");t=parseFloat(t.replace(/[^0-9\.]/g,"")),e(this).val(t)}))}))}(jQuery);